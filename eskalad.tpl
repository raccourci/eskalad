___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Raccourci",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "event",
    "displayName": "Evenement",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "eventCategory",
    "displayName": "Catégorie",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "eventAction",
    "displayName": "Action",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "eventLabel",
    "displayName": "Label",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "sheet",
    "displayName": "Fiche",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "playlist",
    "displayName": "Playlist",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "page",
    "displayName": "Page",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "referrer",
    "displayName": "Referrer",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "siteKey",
    "displayName": "Clé du site",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "accessKey",
    "displayName": "Clé API",
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Saisissez le code de votre modèle ici.
const log = require('logToConsole');
const makeString = require('makeString');
const toBase64 = require('toBase64');
const sendPixel = require('sendPixel');

function isNull(variable) {
  return variable == null || variable == undefined || variable == "";
}

function toJSON(map) {
  let result = '{';
  for(const key in map) {
    const value = map[key];
    if(typeof value == 'function') {
      continue;
    }
    result += '"' + key + '": ';
    if(isNull(value)) {
      result += 'null';
    } else if(typeof value == 'object') {
      result += toJSON(value);
    } else if(typeof value == 'number') {
      result += value;
    } else {
      result += '"' + value + '"';
    }
    result += ', ';
  }
  return result.slice(0, -2) + '}';
}

const url = 'https://api.tourism-system.com/v2/kpi/stats/google-tag-manager?data=' + toBase64(toJSON(data)) + '&key=' + data.accessKey;
sendPixel(url);


// Appelez data.gtmOnSuccess une fois la balise terminée.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://api.tourism-system.com/v2/kpi/stats/*"
              },
              {
                "type": 1,
                "string": "https://api.tourism-system.rc-preprod.com/v2/kpi/stats/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 10/04/2020 à 15:15:39


